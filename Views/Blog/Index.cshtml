@{
    ViewData["Title"] = "Blogs";
}
@model List<Blog>

<div class="wrapper">
  <nav id="sidebar">
    <div class="sidebar-header">
      Blog Filter
    </div>

    <ul class="list-unstyled components">
      <p>Filter Blogs</p>
      <li>
        @for(int i = 0; i < ViewBag.blogCountByYear.Count; i++)
        {
          int year = ViewBag.Now.Year;
          int month = ViewBag.Now.Month;
          <a href="#yearSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle blog-filter">@year (@ViewBag.blogCountByYear[year])</a>
          <ul class="collapse list-unstyled" id="yearSubmenu">
          @foreach(KeyValuePair<DateTime, int> blog in ViewBag.blogCountByMonth)
          {
            if(blog.Value != 0 && blog.Key.Year == year && blog.Key.Month == month)
            {
              <li><a href="#" class="blog-filter">@blog.Key.ToString("MMM") (@blog.Value)</a></li>
            }
            month--;
          }
          </ul>
          year--;
        }
      </li>
    </ul>
  </nav>

  <div id="content">
    <nav class="navbar navbar-expand-lg navbar-light bg-light mt-20">
      <div class="container-fluid">
        <button type="button" id="sidebarCollapse" class="btn btn-info">
          <i class="fas fa-align-left"></i>
          <span>Toggle Filter</span>
        </button>
        @if(ViewBag.isAdmin == true)
        {
          <a asp-action="CreateForm">
            <button class="btn btn-info">
              <span>Create Blog</span>
            </button>
          </a>
        }
      </div>
    </nav>

    <h1>@Model[0].CreatedAt.ToString("MMMM")</h1>
    <div class="row justify-content-md-center blog-box">
      <div class="col-2 text-center blog-box-date">
        <h4>@Model[0].CreatedAt.Day</h4>
        <h4>@Model[0].CreatedAt.ToString("ddd")</h4>
        <h4>@Model[0].CreatedAt.ToString("HH:mm")</h4>
      </div>
      <div class="col-9 blog-box-preview">
        <h4>
          <a asp-action="Info" asp-route-title="@Model[0].Title">@Model[0].Title</a>
        </h4>
        <p>
          @Model[0].Content
        </p>
      </div>
    </div>
    @for (int i = 1; i < Model.Count; i++)
    {
      if (Model[i].CreatedAt.Month != Model[i-1].CreatedAt.Month)
      {
        <h1>@Model[i].CreatedAt.ToString("MMMM")</h1>
      }
      <div class="row justify-content-md-center blog-box">
        <div class="col-2 text-center blog-box-date">
          <h4>@Model[i].CreatedAt.Day</h4>
          <h4>@Model[i].CreatedAt.ToString("ddd")</h4>
          <h4>@Model[i].CreatedAt.ToString("HH:mm")</h4>
        </div>
        <div class="col-9 blog-box-preview">
          <h4><a asp-action="Info" asp-route-title="@Model[i].Title">
            @Model[i].Title
          </a></h4>
          <p>
            @Model[i].Content
          </p>
        </div>
      </div>
    }

  </div>
</div>